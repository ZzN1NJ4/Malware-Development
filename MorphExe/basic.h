#pragma once

#include <stdio.h>
#include <Windows.h>
#include <winternl.h>

#define okay(msg, ...) printf("[+] " msg "\n", ##__VA_ARGS__)
#define info(msg, ...) printf("[*] " msg "\n", ##__VA_ARGS__)
#define warn(msg, ...) printf("[-] " msg "\n", ##__VA_ARGS__)
#define coolcmd(msg, ...) printf("[>] " msg "\n", ##__VA_ARGS__)
#define imp(msg, ...) printf("[#] " msg "\n", ##__VA_ARGS__)


HMODULE Modder(IN LPCWSTR mName, IN DWORD SILENT) {
    HMODULE hModule = NULL;
    if (SILENT != TRUE)
        info("Getting Handle for %S", mName);
    hModule = GetModuleHandleW(mName);

    if (hModule == INVALID_HANDLE_VALUE) {
        if (SILENT != TRUE)
            warn("Failed to get Handle for %S, Error @---0x%ld", mName, GetLastError());
        return NULL;
    }
    else {
        if (SILENT != TRUE)
            okay("Got Handle to %S  @---0x%p", mName, hModule);
        return hModule;
    }
    return NULL;
}

typedef NTSTATUS(NTAPI* pNtQueryInformationProcess)(
    _In_ HANDLE ProcessHandle,
    _In_ PROCESSINFOCLASS ProcessInformationClass,
    _Out_writes_bytes_(ProcessInformationLength) PVOID ProcessInformation,
    _In_ ULONG ProcessInformationLength,
    _Out_opt_ PULONG ReturnLength
    );